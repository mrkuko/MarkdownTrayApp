<Window x:Class="MarkdownTrayApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Markdown Tray App"
        Height="600" Width="800"
        WindowStartupLocation="CenterScreen"
        Closing="Window_Closing">
    <Window.Resources>
        <!-- Theme Brushes -->
        <SolidColorBrush x:Key="LightBackgroundBrush" Color="Snow"/>
        <SolidColorBrush x:Key="LightForegroundBrush" Color="Black"/>
        <SolidColorBrush x:Key="DarkBackgroundBrush" Color="#2D2D30"/>
        <SolidColorBrush x:Key="DarkForegroundBrush" Color="White"/>

        <!-- Theme Styles -->
        <Style x:Key="LightTheme" TargetType="Window">
            <Setter Property="Background" Value="{StaticResource LightBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource LightForegroundBrush}"/>
        </Style>
        <Style x:Key="DarkTheme" TargetType="Window">
            <Setter Property="Background" Value="{StaticResource DarkBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource DarkForegroundBrush}"/>
        </Style>
        
        <!-- Shared Dynamic Brushes for Controls -->
        <SolidColorBrush x:Key="BackgroundBrush" Color="{Binding Source={x:Static SystemColors.WindowColorKey}}"/>
        <SolidColorBrush x:Key="ForegroundBrush" Color="{Binding Source={x:Static SystemColors.WindowTextColorKey}}"/>

        <!-- TabControl Style -->
        <Style TargetType="TabControl">
            <Setter Property="Background" Value="{DynamicResource BackgroundBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource ForegroundBrush}"/>
        </Style>
        <!-- TabItem Style -->
        <Style TargetType="TabItem">
            <Setter Property="Background" Value="{DynamicResource BackgroundBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource ForegroundBrush}"/>
        </Style>
        <!-- GroupBox Style -->
        <Style TargetType="GroupBox">
            <Setter Property="Background" Value="{DynamicResource BackgroundBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource ForegroundBrush}"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <TabControl Grid.RowSpan="2" Margin="0,0,0,0">
            <TabItem Header="Settings">
                <!-- Settings Panel -->
                <GroupBox Header="Settings" Grid.Row="0" Margin="10">
                    <StackPanel>
                        <!-- Theme Selection -->
                        <StackPanel Orientation="Horizontal" Margin="5">
                            <Label Content="Theme:" Width="120"/>
                            <RadioButton x:Name="rbLight" Content="Light Mode" 
                                 Margin="5,0" IsChecked="True" 
                                 Checked="Theme_Changed" GroupName="Theme"/>
                            <RadioButton x:Name="rbDark" Content="Dark Mode" 
                                 Margin="5,0" 
                                 Checked="Theme_Changed" GroupName="Theme"/>
                        </StackPanel>

                        <!-- Directory Path -->
                        <StackPanel Orientation="Horizontal" Margin="5">
                            <Label Content="Top Directory:" Width="120"/>
                            <TextBox x:Name="txtDirectory" Width="400" Margin="5,0"/>
                            <Button Content="Browse..." Click="BrowseDirectory_Click" 
                            Width="80" Margin="5,0"/>
                        </StackPanel>

                        <!-- Filenames to Search -->
                        <StackPanel Margin="5">
                            <Label Content="Filenames to Search (one per line):"/>
                            <TextBox x:Name="txtFilenames" Height="80" 
                             TextWrapping="Wrap" AcceptsReturn="True"
                             VerticalScrollBarVisibility="Auto"
                             Text=""/>
                        </StackPanel>

                        <!-- Action Buttons -->
                        <Separator/>
                        <StackPanel Orientation="Horizontal" Margin="5" 
                            HorizontalAlignment="Right">
                            <Button Content="Scan Files" Click="ScanFiles_Click" 
                            Width="100" Margin="5,0"/>
                            <Button Content="Save Settings" Click="SaveSettings_Click" 
                            Width="100" Margin="5,0"/>
                            <Button Content="Hide to Tray" Click="HideToTray_Click" 
                            Width="100" Margin="5,0"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>
            </TabItem>
            <TabItem Header="Results">
                <!-- Results Panel -->
                <GroupBox Header="Markdown Files Content" Grid.Row="1" Margin="10">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <TreeView x:Name="tvResults" Background="Transparent">
                            <TreeView.ItemTemplate>
                                <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                                    <TextBlock Text="{Binding DisplayText}" 
                                       FontFamily="Consolas"
                                       Margin="2"/>
                                </HierarchicalDataTemplate>
                            </TreeView.ItemTemplate>
                        </TreeView>
                    </ScrollViewer>
                </GroupBox>
            </TabItem>
        </TabControl>
    </Grid>
</Window>